<header class="app-header">
  <div class="brand" routerLink="/callapi">GameForge</div>

  <nav class="primary-nav">
    <a routerLink="/callapi" routerLinkActive="active">Store</a>
    <a routerLink="/library" routerLinkActive="active">Library</a>
    <a routerLink="/wallet" routerLinkActive="active">Wallet</a>
    <a *ngIf="(user$ | async)?.role === 'admin'" routerLink="/admin" routerLinkActive="active">Admin</a>
  </nav>

  <div class="header-actions">
    <ng-container *ngIf="cartState$ | async as cart">
      <div class="cart-chip" routerLink="/callapi">
        <span class="icon">ðŸ›’</span>
        <span class="label">Cart</span>
        <span class="count">{{ cart.items.length }}</span>
      </div>
    </ng-container>

    <ng-container *ngIf="user$ | async as user; else guestLinks">
      <div class="wallet" routerLink="/wallet">
        <span class="label">Balance</span>
        <span class="amount">{{ user.walletBalance | number:'1.2-2' }} à¸¿</span>
      </div>
      <button class="profile" [routerLink]="['/profile', user.id]">
        <img [src]="user.avatarUrl || 'https://avatars.dicebear.com/api/initials/' + user.username + '.svg'" [alt]="user.username" />
        <span class="username">{{ user.username }}</span>
      </button>
      <button class="logout" type="button" (click)="logout()">Sign out</button>
    </ng-container>

    <ng-template #guestLinks>
      <a class="cta" routerLink="/register">Create account</a>
      <a class="cta" routerLink="/">Sign in</a>
    </ng-template>
  </div>
</header>
